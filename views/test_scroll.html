<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Food and Sound of Franklin Street</title>

<script src='https://api.mapbox.com/mapbox.js/v3.1.1/mapbox.js'></script>
    <script src="https://maps.googleapis.com/maps/api/js?v=3&ext=.js"></script>
<link href='https://api.mapbox.com/mapbox.js/v3.1.1/mapbox.css' rel='stylesheet' />
<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="/css/scroll.css" rel="stylesheet">
<link rel="stylesheet" href="/css/leaflet.label.css" />
<link rel="stylesheet" href="https://unpkg.com/flickity@2/dist/flickity.css">

<style type="text/css">
  @font-face {
      font-family: gotham_book;
      src: url(gotham-book.ttf);
  }
  @font-face {
      font-family: gotham_light;
      src: url(gotham-light.otf);
  }
</style>
</head>

<body>
  <script src="/js/d3.min.js"></script>
  <script src="/js/queue.min.js"></script>
  <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
  <script src='/js/leaflet.label.js'></script>

  <div class='custom-popup' id='map' style="display: none;"></div>
  <div id="gmap-list"></div>
  <!-- <div id="timeline"></div> -->
  <div id="image"></div>
  <div id="pointing"></div>
<!--   <div id="citymap"></div> -->
<h2 id='h2' style="top: 37%;color:#fff;">FRANKLIN STREET, CHAPEL HILL</h2>
<!-- <div id="modal-map-too"></div> -->

<div id='bg_intro'>
  <a href='/test' style="text-decoration:none">
    <div id='h1_2'>Food and Sound of Franklin Street</div>
  </a>
  <hr style="position:relative; opacity:0.6; margin:20px; margin-top:25px; height:0px;">
<!--   <img src="south_africa_sm.png" width="122" style="padding-top: 40px; border-radius: 8px; opacity: 0.82"> -->
  <div id='h1_3' style="opacity:1">
  Key to navigate to different categories of markers.
  </div><br>
<ul class="form">
            <input id="monumentoCheckbox" type="checkbox" onclick="toggleGroup('monumento')" checked="checked"><label>K-Pop</label></input>
            <input id="museusCheckbox" type="checkbox" onclick="toggleGroup('museus')" checked="checked"><label>Rock</label></input>
            <input id="restaurantesCheckbox" type="checkbox" onclick="toggleGroup('restaurantes')" checked="checked"><label>Pop</label></input>
            <input id="hotelCheckbox" type="checkbox" onclick="toggleGroup('hotel')" checked="checked"><label>Country</label></input>
        </ul>

  <div id='h1_3' style="float: left; top:152px"><span style='color:yellow'>City : </span> Franklin Street, <br>Chapel Hill</div>
</div>
 
<div id="cityname"></div>
<!-- <h5 id='h5' style="visibility: hidden; font-weight: bold">
 <span style="font-size: 19px !important">Dec 2009 - Nov 2010</span>
        <a href='/test'><img src="/img/logo-white.png" width="120" ></a><br><br>
 Ethnographic fieldwork about freedom songs and protest dances served as tactics of 
    liberation struggles in Johannesburg, South Africa
</h5> -->

<div id="current_date"></div>

<!-- <img id="southAftica" src="south_africa3.png" width="180px" style="position: fixed; left:2.5%; bottom: 80px"> -->

<h4 id='scroll' style="color: #fff; bottom: -5px;">SCROLL TO NAVIGATE</h4>
<div id='close' class='btn button'><a href='#'>Close</a></div>
<h2 id='title'>#</h2>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.0.47/jquery.fancybox.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.0.47/jquery.fancybox.min.js"></script>
    <script type="text/javascript" src="/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="https://blackrockdigital.github.io/startbootstrap-simple-sidebar/css/simple-sidebar.css" />
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500">
    <script src="/js/styles.js"></script>
<!--     <link rel="stylesheet" href="/css/material-modal.css"> -->

<script>
  function xmlParse(str) {
    if (typeof ActiveXObject != 'undefined' && typeof GetObject != 'undefined') {
        var doc = new ActiveXObject('Microsoft.XMLDOM');
        doc.loadXML(str);
        return doc;
    }

    if (typeof DOMParser != 'undefined') {
        return (new DOMParser()).parseFromString(str, 'text/xml');
    }

    return createElement('div', null);
}
var infoWindow = new google.maps.InfoWindow();
var customIcons = {
    monumento: {
        icon: 'http://maps.google.com/mapfiles/ms/icons/blue.png'
    },
    hotel: {
        icon: 'http://maps.google.com/mapfiles/ms/icons/green.png'
    },
    restaurantes: {
        icon: 'http://maps.google.com/mapfiles/ms/icons/yellow.png'
    },
    museus: {
        icon: 'http://maps.google.com/mapfiles/ms/icons/purple.png'
    }
};

var markerGroups = {
    "museus": [],
        "monumentos": [],
        "restaurantes": [],
        "hotel": []
};

function load() {
    var map = new google.maps.Map(document.getElementById("gmap-list"), {
        center: new google.maps.LatLng(35.9120,-79.0537),
        zoom: 20,
        mapTypeId: 'satellite'
    });
    var infoWindow = new google.maps.InfoWindow();



    map.set('styles', [{
        zoomControl: false
    }, {
        featureType: "road.highway",
        elementType: "geometry.fill",
        stylers: [{
            color: "#ffd986"
        }]
    }, {
        featureType: "road.arterial",
        elementType: "geometry.fill",
        stylers: [{
            color: "#9e574f"
        }]
    }, {
        featureType: "road.local",
        elementType: "geometry.fill",
        stylers: [{
            color: "#d0cbc0"
        }, {
            weight: 1.1
        }

        ]
    }, {
        featureType: 'road',
        elementType: 'labels',
        stylers: [{
            saturation: -100
        }]
    }, {
        featureType: 'landscape',
        elementType: 'geometry',
        stylers: [{
            hue: '#ffff00'
        }, {
            gamma: 1.4
        }, {
            saturation: 82
        }, {
            lightness: 96
        }]
    }, {
        featureType: 'poi.school',
        elementType: 'geometry',
        stylers: [{
            hue: '#fff700'
        }, {
            lightness: -15
        }, {
            saturation: 99
        }]
    }]);

    var xml = xmlParse('<markers><marker name="Starbucks" address="sgfd" lat="35.9140" lng="-79.0537" type="restaurantes" /><marker name="Monkeys" address="Estrada Nacional 114" lat="35.9140" lng="-79.0538" type="monumento" /><marker name="Hotel da Ameira" address="Herdade da Ameira" lat="38.64109640475479" lng="-8.180432206726096" type="hotel" /><marker name="Hotel Montemor" address="Avenida Gago Coutinho 8, 7050-248 Montemor-o-Novo" lat="38.64925541964039" lng="-8.216489625644726" type="hotel" /><marker name="Restaurante Monte Alentejano" address="Av. Gago Coutinho 8" lat="38.6492329" lng="-8.216665" type="restaurantes" /><marker name="Restaurante A Ribeira" address="Rua de São Domingos" lat="38.6347498199708" lng="-8.206468892765088" type="restaurantes" /><marker name="Núcleo Museológico do Convento de S. Domingos" address="" lat="38.643139" lng="-8.212732" type="museus" /><marker name="Centro Interpretativo do Castelo de Montemor-o-Novo" address="Rua Condessa de Valença" lat="38.64258748216167" lng="-8.21467108793263" type="museus" /></markers>');
    // var xml = data.responseXML;
    embeds = ['<iframe width="560" height="315" src="https://www.youtube.com/embed/PyI-RjfE0ks" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>','<iframe width="560" height="315" src="https://www.youtube.com/embed/y4Ccm-kUDSM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>'];

    var markers = xml.documentElement.getElementsByTagName("marker");
    for (var i = 0; i < markers.length; i++) {
        var name = markers[i].getAttribute("name");
        var address = markers[i].getAttribute("address");
        var type = markers[i].getAttribute("type");
        var embed = embeds[i];

        var point = new google.maps.LatLng(
        parseFloat(markers[i].getAttribute("lat")),
        parseFloat(markers[i].getAttribute("lng")));
        var html = "<b>" + name + "</b> <br/>" + address + embed;
        // var icon = customIcons[type] || {};
        var marker = createMarker(point, name, address, type, map);
        bindInfoWindow(marker, map, infoWindow, html);
    }
    // });
}

function createMarker(point, name, address, type, map) {
    var icon = customIcons[type] || {};
    var marker = new google.maps.Marker({
        map: map,
        position: point,
        icon: icon.icon,
        // shadow: icon.shadow,
        type: type
    });
    if (!markerGroups[type]) markerGroups[type] = [];
    markerGroups[type].push(marker);
    var html = "<b>" + name + "</b> <br/>" + address;
    bindInfoWindow(marker, map, infoWindow, html);
    return marker;
}

function toggleGroup(type) {
    for (var i = 0; i < markerGroups[type].length; i++) {
        var marker = markerGroups[type][i];
        if (!marker.getVisible()) {
            marker.setVisible(true);
        } else {
            marker.setVisible(false);
        }
    }
}

function bindInfoWindow(marker, map, infoWindow, html) {
    google.maps.event.addListener(marker, 'click', function () {
        infoWindow.setContent(html);
        infoWindow.open(map, marker);

    });
}

function downloadUrl(url, callback) {
    var request = window.ActiveXObject ? new ActiveXObject('Microsoft.XMLHTTP') : new XMLHttpRequest();

    request.onreadystatechange = function () {
        if (request.readyState == 4) {
            request.onreadystatechange = doNothing;
            callback(request, request.status);
        }
    };

    request.open('GET', url, true);
    request.send(null);
}

function doNothing() {}
google.maps.event.addDomListener(window, 'load', load);
  </script>
<!--     <script src="/js/maplace.js"></script> -->
    <script src="/js/timeline2.js"></script>
    <script src="/js/imageRetrieval.js"></script>
    <script src="/js/scroll2.js"></script>
    <script src="/js/markers.js"></script>
  </body>
</html>